{%
Dim useList   = (CurrentADC.PropValue("useList") = "1") ' Convert to boolean
Dim inputName = CurrentQuestion.InputName()
Dim inputValue
Dim caption
Dim resource
Dim i
Dim j
Dim attrSelected
Dim isHeader
Dim showHeader    = CurrentADC.PropValue("showHeaders") ="1"

If useList Then
    attrSelected = On(CurrentQuestion.HasDK or CurrentQuestion.HasNA, " selected=\"selected\"", "") %}
<select name="{%= inputName %}" aria-label="Select">
        <option value="" disabled="disabled"{%:= attrSelected %}>{%:= CurrentADC.PropValue("firstOptionText") %}</option>
    {%
    For i = 1 To CurrentQuestion.Responses.Count
        attrSelected = On(CurrentQuestion.Responses[i].IsSelected, "selected=\"selected\"", "")
        inputValue   = CurrentQuestion.Responses[i].InputValue()
        caption      = CurrentQuestion.Responses[i].Caption
        isHeader     = CurrentQuestion.Responses[i].isHeader

        If isHeader = False or showHeader = True Then
        IF isHeader = True Then
        %}
        <optgroup label="{%= caption %}">
          {%
            Dim cr = CurrentQuestion.Responses[i].Children
            For j = 1 To cr.Count
          %}
          <option value="{%= inputValue %}" {%:= attrSelected %}>{%= cr[j].Caption %}</option>
          {% Next j %}
        </optgroup>
        {% ElseIf CurrentQuestion.Responses[i].Parent.isHeader <> True Then %}
        <option value="{%= inputValue %}" {%:= attrSelected %}>{%= caption %}</option>
        {% EndIF %}
        {% EndIF %}
    {% Next %}
    </select>
{% Else %}
    <ul>
        {%
        Dim inputId
        Dim attrChecked
        For i = 1 To CurrentQuestion.Responses.Count
            inputId     = (inputName + "_" + i).Replace("U", "askia-input")
            attrChecked = On(CurrentQuestion.Responses[i].IsSelected, "checked=\"checked\"", "")
            inputValue  = CurrentQuestion.Responses[i].InputValue()
            caption     = CurrentQuestion.Responses[i].Caption
			      resource	= CurrentQuestion.Responses.ResourceURL[i]

            isHeader     = CurrentQuestion.Responses[i].isHeader
            If isHeader = False or showHeader = True Then
            IF isHeader = True Then
            %}
            <li class="responseHeader" onmousedown="return false;">{%:= caption %}</li>
            {% Else %}
            <li class="askia-response">
                <input type="radio" name="{%= inputName %}" id="{%= inputId %}" value="{%= inputValue %}" {%:= attrChecked %} />
                <label for="{%= inputId %}" class="askia-radio"><span hidden>Radio</span></label>
                <label for="{%= inputId %}" class="askia-response-label">
                    {% IF (resource <> "") Then %}
                    <img src="{%= resource %}" style="vertical-align:middle" alt="{%:= caption %}"/>
                    {% EndIf %}{%:= caption %}</label>
            </li>
            {% EndIF %}
            {% EndIF %}          
        {% Next %}
    </ul>
{% EndIf %}
