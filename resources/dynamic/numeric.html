{% 
Dim useList    =  (CurrentADC.PropValue("useList") = "1") ' Convert to boolean

Dim useInput = CurrentADC.PropValue("numUseInput")

Dim inputName  = CurrentQuestion.InputName()
Dim inputValue = CurrentQuestion.InputValue()
Dim minValue  = CurrentQuestion.MinValue
Dim maxValue  = CurrentQuestion.MaxValue
Dim rangeLength = 0

Dim attrMin = On(minValue <> DK, "min=\"" + minValue + "\"", "")
Dim attrMax = On(maxValue <> DK, "max=\"" + maxValue + "\"", "")

Dim placeholder = CurrentADC.PropValue("placeholder")
Dim attrPlaceholder = On(placeholder <> "", "placeholder=\"" + placeholder + "\"", "")

Dim attrRequired = On(CurrentQuestion.IsAllowDK, "required=\"required\"", "")

Dim unitStep = CurrentADC.PropValue("unitStep").ToNumber()
Dim attrStep = On(unitStep > 1, "step=\"" + unitStep + "\"", "")

If useList And minValue <> DK And maxValue <> DK Then
    rangeLength = (maxValue - minValue) / unitStep
EndIf

If rangeLength > 0 And rangeLength <= 20 Then
    Dim i
    Dim x = minValue
%}
    <select name="{%= inputName %}">
        <option value="">{%:= CurrentADC.PropValue("firstOptionText") %}</option>    
    {% For i = 0 To rangeLength %}
        <option value="{%:= x %}">{%= CurrentADC.PropValue("numBoxPrefix") %}{%:= x %}{%= CurrentADC.PropValue("numBoxSuffix") %}</option>
        {% x = x + unitStep %}
    {% Next %}
    </select>
{% Else %}
	<span class="prefix">{%= CurrentADC.PropValue("numBoxPrefix") %}</span>
    <input type="number" id="{%= inputName %}" class="inputnumber" name="{%= inputName %}" value="{%:= inputValue %}" {%:= attrMin %} {%:= attrMax %} {%:= attrStep %} {%:= attrPlaceholder %} {%:= attrRequired %}/>
	{% If (useInput = "2") Then %}
	<input type="text" name="currency_{%= inputName %}" value="{%:= inputValue %}" class="thousand" />
	{% EndIf %}
	<span class="suffix">{%= CurrentADC.PropValue("numBoxSuffix") %}</span>
{% EndIf %}
